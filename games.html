<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Game</title>
  <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
  <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
  <style>
    /* Full-screen iframe style */
   /* Full-screen iframe style */
iframe {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  border: none;
  display: none;
  /* Initially hide the iframe */
  z-index: 1; /* Set iframe z-index to 1 to be below the navbar */
}

/* Collapsible navbar (sidebar) */
.navbar {
  position: fixed;
  top: 0;
  left: -55px; /* Hide the navbar offscreen initially */
  height: 15%;
  width: 50px; /* Initial width of the navbar */
  background-color: rgba(0, 0, 0, 0.8);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  z-index: 9999; /* Ensure navbar stays on top */
  padding: 10px;
  box-shadow: 2px 0 5px rgba(0, 0, 0, 0.5);
  transition: left 0.3s ease; /* Smooth opening and closing animation */
}


    /* Navbar open state */
    .navbar.open {
      left: 0; /* Slide the navbar into view */
    }

    /* Arrow button inside the navbar */
    .toggle-button {
      position: absolute;
      top: 50%;
      right: -25px; /* Arrow inside the navbar */
      transform: translateY(-50%);
      width: 30px;
      height: 30px;
      background-color: rgba(0, 0, 0, 0.8);
      color: white;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      z-index: 10000;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 2px 0 5px rgba(0, 0, 0, 0.5);
    }

    /* Arrow icon */
    .toggle-button ion-icon {
      font-size: 40px;
    }

    /* Style for individual nav buttons */
    .nav-button {
      width: 40px;
      height: 40px;
      background-color: rgba(0, 30, 255, 0.5);
      color: white;
      border: none;
      border-radius: 50%;
      font-size: 20px;
      line-height: 40px;
      text-align: center;
      cursor: pointer;
      margin-bottom: 10px;
      transition: transform 0.3s ease;
    }

    /* Hover effect for buttons */
    .nav-button:hover {
      transform: scale(1.2);
      background-color: rgba(0, 18, 148, 0.8);
    }

    /* Font Awesome icons container */
    .nav-button i {
      display: flex;
      justify-content: center;
      align-items: center;
    }

    /* Preloader styling */
    #preloader {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgb(32, 32, 32);
      /* Dark overlay */
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      opacity: 1;
      transition: opacity 1s ease;
    }

    #preloader-container {
      text-align: center;
    }

    #preloader img {
      width: 100px;
      height: auto;
    }

    #preloader-text {
      color: white;
      font-size: 20px;
      font-weight: bold;
      margin-top: 20px;
    }

    /* Gradient background */
    body {
      background: linear-gradient(to bottom, #5a5959, #292828);
      font-family: Arial, sans-serif;
      height: 100vh;
      margin: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
    }

    /* No Game Found Message */
    .no-game-found {
      text-align: center;
      font-size: 36px;
      margin-top: 100px;
      color: white;
    }
  </style>
</head>

<body>

  <!-- Preloader -->
  <div id="preloader">
    <div id="preloader-container">
      <img src="https://raw.githubusercontent.com/n3r4zzurr0/svg-spinners/refs/heads/main/svg-css/blocks-shuffle-3.svg"
        alt="Loading..."> <!-- Replace with your rocket gif path -->
      <p id="preloader-text"></p>
    </div>
  </div>

  <!-- Navbar with buttons and logo -->
  <div class="navbar" id="navbar">
    <button id="home-button" class="nav-button" onclick="goHome()">
      <ion-icon name="home-sharp"></ion-icon>
    </button>
    <button id="fullscreen-button" class="nav-button" onclick="toggleFullScreen()">
      <i class="fas fa-expand"></i>
    </button>
    <button class="toggle-button" onclick="toggleNavbar()">
      <ion-icon name="arrow-forward-sharp"></ion-icon>
    </button>
  </div>

  <!-- Embedding the Game File -->
  <iframe id="game-iframe" src="" title="Your Game"></iframe>

  <!-- No Game Found Message -->
  <h1 id="no-game-message" class="no-game-found" style="display: none;">
    Hmm that's odd, couldn't find a game URL. Try again and if this error appears multiple times, <strong>Contact me for
      a fix!</strong>
  </h1>

  <!-- Font Awesome Icons -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/js/all.min.js"></script>

  <script>
    // Function to get query parameter by name
    function getQueryParam(name) {
      const urlParams = new URLSearchParams(window.location.search);
      return urlParams.get(name);
    }

    const gameUrl = getQueryParam('game'); // Get the 'game' parameter from the URL
    const preloaderText = [
      "Searching game....",
      "Loading game...",
      "Decompiling assets...",
      "Launching game."
    ];
    let textIndex = 0;
    const preloaderTextElement = document.getElementById('preloader-text');
    const preloader = document.getElementById('preloader');
    const gameIframe = document.getElementById('game-iframe');
    const noGameMessage = document.getElementById('no-game-message');
    let preloaderTimer;

    // Function to change the preloader text every 2 seconds
    function cyclePreloaderText() {
      preloaderTimer = setInterval(() => {
        preloaderTextElement.textContent = preloaderText[textIndex];
        textIndex = (textIndex + 1) % preloaderText.length; // Loop through the text array
      }, 2000); // Change text every 2 seconds
    }

    // Function to stop the preloader and display the game
    function stopPreloader() {
      clearInterval(preloaderTimer); // Stop cycling preloader text
      preloader.style.opacity = '0'; // Fade out the preloader
      setTimeout(() => {
        preloader.style.display = 'none'; // Hide the preloader completely
        if (gameUrl) {
          // If a valid game URL exists, show the iframe and load the game
          gameIframe.style.display = 'block';
        } else {
          // If no valid game URL is found, show the "No Game Found" message
          noGameMessage.style.display = 'block';
        }
      }, 1000); // Delay to match fade-out duration
    }

    // Start cycling preloader text
    cyclePreloaderText();

    // Load the game if a valid URL exists
    if (gameUrl) {
      gameIframe.src = gameUrl; // Set the iframe source once
      gameIframe.onload = stopPreloader; // Stop preloader when iframe loads
    } else {
      stopPreloader(); // Stop preloader immediately if no URL is found
    }

    // Function to navigate back to the homepage
    function goHome() {
      window.location.href = 'main.html'; // Go back to homepage
    }

    // Toggle fullscreen for the iframe
    function toggleFullScreen() {
      const iframe = document.querySelector('iframe');
      if (!document.fullscreenElement) {
        iframe.requestFullscreen().catch(err => {
          alert(`Error attempting to enable full-screen mode: ${err.message} (${err.name})`);
        });
      } else {
        document.exitFullscreen();
      }
    }

    // Toggle navbar open and close
    function toggleNavbar() {
      const navbar = document.getElementById('navbar');
      const toggleButton = document.querySelector('.toggle-button ion-icon');
      navbar.classList.toggle('open');
      if (navbar.classList.contains('open')) {
        toggleButton.setAttribute('name', 'arrow-back-sharp'); // Change to back arrow
      } else {
        toggleButton.setAttribute('name', 'arrow-forward-sharp'); // Change to forward arrow
      }
    }
  </script>

</body>

</html>
